# Tcp ip 学习笔记

## ipv4和ipv6的区别

### 1.ipv4和ipv6之间最大的差别是地址长度不同

> 32位的ipv4地址，128位的ipv6地址

### 2.ICMP控制消息协议是ip的一个辅助协议
> IPv4使用的是ICMPv4，IPv6使用的是ICMPv6

### 3.IP地址表示法
> IPv4地址，采用所谓的点分四组或点分十进制表示法，例如165.195.130.107。由四个用点分隔的十进制数组成，是个非负数字，范围[0, 255]。
> IPv6地址，采用所谓的8个块的IPv6地址，例如：5f05:2000:80ad:5800:0058:0058:0800:2023:1d71

## 子网掩码

### 1.ip分类
> A类 8位网络标识（7位自由），24位主机标识；0.0.0.0 ～ 127.255.255.255

> B类 16位网络标识（14位自由），16位主机标识；128.0.0.0 ～ 191.255.255.255

> C类 24位网络标识（21位自由），8位主机标识；192.0.0.0 ～ 223.255.255.255

### 2.子网寻址
> 在一个站点接入网络后，为其分配一个网络号。在主机标识部分进一步划分一个子网号和主机号。子网寻址为ip地址结构增加了一个额外的部分，但是对地址长度没有改变。例如b类ip：

> B类 16位网络标识（14位自由），16位主机标识（8位子网ID，8位主机ID）；

### 3.子网
> IP地址是以网络号和主机号来表示网络上的主机的，只有在一个网络号下的计算机之间才能“直接”互通，不同网络号的计算机要通过网关（Gateway）才能互通。但这样的划分在某些情况下显得并不十分灵活。为此IP网络还允许划分成更小的网络，称为子网（Subnet），这样就产生了子网掩码。子网掩码的作用就是用来判断任意两个IP地址是否属于同一子网络，这时只有在同一子网的计算机才能"直接"互通。

### 4.通过子网掩码计算网络地址
> IP地址和子网掩码进行与运算，结果是网络地址 

> 举个例子：

```
192.168.100.5       11000000:10101000:01100100:00000101
255.255.255.0			11111111:11111111:11111111:00000000
``` 
> 将IP地址和子网掩码换算为二进制，子网掩码连续全1的是网络地址，后面的是主机地址。 虚线前为网络地址，虚线后为主机地址
 
> 进行与运算 结果就是网络地址

### 5.DNS解析查询
> 1、在浏览器中输入www.qq.com 域名，操作系统会先检查自己本地的hosts文件是否有这个网址映射关系，如果有，就先调用这个IP地址映射，完成域名解析。 

> 2、如果hosts里没有这个域名的映射，则查找本地DNS解析器缓存，是否有这个网址映射关系，如果有，直接返回，完成域名解析。 

> 3、如果hosts与本地DNS解析器缓存都没有相应的网址映射关系，首先会找TCP/ip参数中设置的首选DNS服务器，在此我们叫它本地DNS服务器，此服务器收到查询时，如果要查询的域名，包含在本地配置区域资源中，则返回解析结果给客户机，完成域名解析，此解析具有权威性。 

> 4、如果要查询的域名，不由本地DNS服务器区域解析，但该服务器已缓存了此网址映射关系，则调用这个IP地址映射，完成域名解析，此解析不具有权威性。 

> 5、如果本地DNS服务器本地区域文件与缓存解析都失效，则根据本地DNS服务器的设置（是否设置转发器）进行查询，如果未用转发模式，本地DNS就把请求发至13台根DNS，根DNS服务器收到请求后会判断这个域名(.com)是谁来授权管理，并会返回一个负责该顶级域名服务器的一个IP。本地DNS服务器收到IP信息后，将会联系负责.com域的这台服务器。这台负责.com域的服务器收到请求后，如果自己无法解析，它就会找一个管理.com域的下一级DNS服务器地址(http://qq.com)给本地DNS服务器。当本地DNS服务器收到这个地址后，就会找http://qq.com域服务器，重复上面的动作，进行查询，直至找到www.qq.com主机。